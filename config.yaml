# Application Configuration
# Note: Sensitive values (passwords, secrets) should be set via environment variables
# Last Updated: 2025-011-22

environment: "development"
service_name: "task-worker"
version: "1.0.0"

worker:
  job_buffer_capacity: 100
  job_worker_count: 5
  task_worker_count: 10

server:
  host: "0.0.0.0"
  port: 8080
  read_timeout: 15s
  write_timeout: 15s
  idle_timeout: 60s
  shutdown_timeout: 30s
  cors:
    enabled: true
    allowed_origins:
      - "http://localhost:3000"
    
    allowed_methods: ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
    allowed_headers: ["Content-Type", "Authorization", "X-Requested-With"]
    allow_credentials: true
    max_age: 2h

database:
  driver: postgres
  host: localhost
  port: 5432
  user: myuser
  password: ""  # Set via APP_DATABASE_PASSWORD environment variable
  db_name: myapp_dev
  max_open_conns: 25
  max_idle_conns: 25
  conn_max_lifetime: 5m
  conn_max_idle_time: 5m
  ssl_mode: disable
  auto_migrate: true
  
  
rate_limit:
  requests_per_second: 100
  burst: 200

logger:
  level: "info"

# Additional Production Settings
# (You can extend the config struct to include these)

# Cache Configuration
cache:
  redis_host: "redis-cluster.internal"
  redis_port: 6379
  redis_db: 0
  redis_password: ""  # Set via REDIS_PASSWORD env var
  ttl: "1h"
  max_retries: 3

# Rate Limiting


# Monitoring & Health Checks
monitoring:
  metrics_enabled: true
  metrics_port: 9090
  health_check_path: "/health"
  readiness_check_path: "/ready"

# Feature Flags
features:
  enable_new_api: false
  enable_experimental_features: false
  maintenance_mode: false

# Security
security:
  cors_enabled: true
  cors_origins:
    - "https://app.example.com"
    - "https://www.example.com"
  jwt_secret: ""  # Set via JWT_SECRET env var
  jwt_expiry: "24h"
  api_key_header: "X-API-Key"

# External Services
external_services:
  payment_api:
    base_url: "https://api.payment-provider.com"
    timeout: "10s"
    retry_count: 3
  email_service:
    base_url: "https://api.email-provider.com"
    timeout: "5s"
    from_address: "noreply@example.com"

# Queue Configuration
queue:
  provider: "rabbitmq"
  host: "rabbitmq.internal"
  port: 5672
  vhost: "/production"
  username: "app_queue_user"
  password: ""  # Set via QUEUE_PASSWORD env var
  prefetch_count: 10

# Storage Configuration
storage:
  provider: "s3"
  bucket: "production-app-storage"
  region: "us-east-1"
  # Access credentials via IAM role or environment variables

# Observability
observability:
  tracing_enabled: true
  tracing_endpoint: "https://tracing.internal:4318"
  sampling_rate: 0.1
  log_sampling_rate: 1.0